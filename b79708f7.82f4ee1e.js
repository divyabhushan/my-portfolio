(window.webpackJsonp=window.webpackJsonp||[]).push([[31],{101:function(e,t,n){"use strict";n.r(t),n.d(t,"frontMatter",(function(){return o})),n.d(t,"metadata",(function(){return s})),n.d(t,"rightToc",(function(){return c})),n.d(t,"default",(function(){return b}));var a=n(3),r=n(7),i=(n(0),n(113)),o=(n(114),n(116),{id:"dockers-vs-vms-old",title:"Docker Vs Virtual Machines(VMs)",sidebar_label:"Docker Vs Virtual Machines(VMs)"}),s={unversionedId:"tech-docs/devops/dockers-vs-vms-old",id:"tech-docs/devops/dockers-vs-vms-old",isDocsHomePage:!1,title:"Docker Vs Virtual Machines(VMs)",description:"Let\u2019s have a quick warm up on the resource management before we dive into the discussion on virtualization and dockers.",source:"@site/docs/tech-docs/devops/dockers-vs-vms-old.md",slug:"/tech-docs/devops/dockers-vs-vms-old",permalink:"/my-portfolio/docs/tech-docs/devops/dockers-vs-vms-old",version:"current",sidebar_label:"Docker Vs Virtual Machines(VMs)"},c=[{value:"<strong>What a machine need?</strong>",id:"what-a-machine-need",children:[]},{value:"<strong>How to manage huge data - Servers</strong>",id:"how-to-manage-huge-data---servers",children:[{value:"<strong>Many Servers approach challenge:</strong>",id:"many-servers-approach-challenge",children:[]}]},{value:"<strong>Virtualization</strong>",id:"virtualization",children:[{value:"What is Virtualization",id:"what-is-virtualization",children:[]},{value:"<em>What is a Virtual machine</em>",id:"what-is-a-virtual-machine",children:[]},{value:"<em>Need</em> <em>for</em> <em>virtualization</em>",id:"need-for-virtualization",children:[]}]},{value:"<em>Implementation</em>",id:"implementation",children:[{value:"<em>a) What is hypervisor and its types__?</em>",id:"a-what-is-hypervisor-and-its-types__",children:[]},{value:"<em>b) Comparing hypervisor types</em>",id:"b-comparing-hypervisor-types",children:[]}]},{value:"<em>Types of virtualization</em>",id:"types-of-virtualization",children:[]},{value:"<strong>Containerization</strong>",id:"containerization",children:[]},{value:"<em>What is containerization</em>",id:"what-is-containerization",children:[]},{value:"<em>What is Dockers</em>",id:"what-is-dockers",children:[{value:"<strong>Ppt diagram:</strong>",id:"ppt-diagram",children:[]},{value:"What is the container environment?",id:"what-is-the-container-environment",children:[]}]},{value:"<em>How to modify and build your own app</em>",id:"how-to-modify-and-build-your-own-app",children:[{value:"<strong>Step 1: pull</strong>",id:"step-1-pull",children:[]},{value:"<strong>Step 2: modify</strong>",id:"step-2-modify",children:[]},{value:"<strong>Step 3: commit</strong>",id:"step-3-commit",children:[]},{value:"<strong>Step 4: push</strong>",id:"step-4-push",children:[]},{value:"<strong>Step 1: pull</strong>",id:"step-1-pull-1",children:[]},{value:"<strong>Step 2: modify</strong>",id:"step-2-modify-1",children:[]},{value:"<strong>Step 3: commit</strong>",id:"step-3-commit-1",children:[]},{value:"<strong>Step 4: push</strong>",id:"step-4-push-1",children:[]}]},{value:"<strong>Difference between Dockers and Virtual machines</strong>",id:"difference-between-dockers-and-virtual-machines",children:[{value:"<em>Tabular differences on various parameters</em>",id:"tabular-differences-on-various-parameters",children:[]}]},{value:"<em>When to use VM or a Docker</em>",id:"when-to-use-vm-or-a-docker",children:[]}],l={rightToc:c};function b(e){var t=e.components,n=Object(r.a)(e,["components"]);return Object(i.b)("wrapper",Object(a.a)({},l,n,{components:t,mdxType:"MDXLayout"}),Object(i.b)("p",null,"Let\u2019s have a quick warm up on the resource management before we dive into the discussion on virtualization and dockers."),Object(i.b)("p",null,"In today\u2019s multi-technology environments, it becomes inevitable to work on different software and hardware platforms simultaneously."),Object(i.b)("p",null,"The need to run multiple different machines (Desktops, Laptops, handhelds, and Servers) platforms with customized hardware and software requirements has given the rise to a new world of ",Object(i.b)("em",{parentName:"p"},"virtualization")," in IT industry."),Object(i.b)("h2",{id:"what-a-machine-need"},Object(i.b)("strong",{parentName:"h2"},"What a machine need?")),Object(i.b)("p",null,"Each computing environment(machine) needs its own component of ",Object(i.b)("em",{parentName:"p"},"hardware resources")," and ",Object(i.b)("em",{parentName:"p"},"software resources.")),Object(i.b)("p",null,"As more and more machines are needed, building up and administering many such stand-alone machines is not only cumbersome, time consuming but also adds up to the cost and energy."),Object(i.b)("p",null,"Apparently; to run a customized ",Object(i.b)("em",{parentName:"p"},"High-power")," ",Object(i.b)("em",{parentName:"p"},"Scalable")," ",Object(i.b)("em",{parentName:"p"},"Server")," is a better idea to consolidate all the hardware and software requirements into one place and have a single server run and distribute the resources to many machines over a network."),Object(i.b)("p",null,"That saves us time, resources, energy and revenue."),Object(i.b)("p",null,"These gigantic servers are stored in a data warehouse called a ",Object(i.b)("em",{parentName:"p"},"Datacenter__.")),Object(i.b)("p",null,"Below Diagram (2) indicates a single ",Object(i.b)("em",{parentName:"p"},"server")," serving and sharing resources and data among multiple client machines"),Object(i.b)("p",null,"Does this look simplified enough? Yes of course!"),Object(i.b)("p",null,"So, this setup looks feasible we have a high-power, high-storage Server that gives resources to many smaller(resources) machines over a network."),Object(i.b)("h2",{id:"how-to-manage-huge-data---servers"},Object(i.b)("strong",{parentName:"h2"},"How to manage huge data - Servers")),Object(i.b)("p",null,"With ",Object(i.b)("em",{parentName:"p"},"Internet Of Things")," in boom, Information is overflowing with a huge amount of data; handling tremendous data needs more system resources which means more _Dedicated server_s are needed."),Object(i.b)("h3",{id:"many-servers-approach-challenge"},Object(i.b)("strong",{parentName:"h3"},"Many Servers approach challenge:")),Object(i.b)("p",null,"Running several ",Object(i.b)("em",{parentName:"p"},"Dedicated servers")," for specific services such as Web service, application or database service as indicated in Diagram (3) is difficult to administer and consumes more energy, resources, manpower and is highly expensive."),Object(i.b)("p",null,"In addition; resource utilization of servers is very poor resulting in resource wastage."),Object(i.b)("p",null,"This is where simulating different environments and running them all on a single server is a smart choice; rather than having to run multiple physically distinct servers."),Object(i.b)("p",null,"This is how Diagram (3) would change after consolidating different servers into one as shown in Diagram (4)."),Object(i.b)("p",null,"Sheet 2"),Object(i.b)("h2",{id:"virtualization"},Object(i.b)("strong",{parentName:"h2"},"Virtualization")),Object(i.b)("h3",{id:"what-is-virtualization"},"What is Virtualization"),Object(i.b)("p",null,"The above single server implementation can be defined as the following term."),Object(i.b)("p",null,Object(i.b)("em",{parentName:"p"},"Virtualization")," is a technique used to simulate and ",Object(i.b)("em",{parentName:"p"},"pretend a single infrastructure")," resource (",Object(i.b)("em",{parentName:"p"},"hardware resources")," and ",Object(i.b)("em",{parentName:"p"},"software resources"),") ",Object(i.b)("em",{parentName:"p"},"to be acting as many")," providing multiple functionalities or services without the need to physically build, install and configure."),Object(i.b)("p",null,"In other words;"),Object(i.b)("p",null,"Running ",Object(i.b)("em",{parentName:"p"},"multiple simulated environments in a single machine without installing and configuring them")," is called ",Object(i.b)("em",{parentName:"p"},"Virtualization"),"."),Object(i.b)("p",null,"Technically speaking;"),Object(i.b)("p",null,"Virtualization is an abstract layer that shares the infrastructure resources among various simulated ",Object(i.b)("em",{parentName:"p"},"virtual machines")," without the need to physically set up these environments."),Object(i.b)("p",null,"Diagram (5) displays different virtual Operating systems are running on the same machine and using the same hardware architecture of the underlying machine."),Object(i.b)("h3",{id:"what-is-a-virtual-machine"},Object(i.b)("em",{parentName:"h3"},"What is a Virtual machine")),Object(i.b)("p",null,"The simulated virtualized environments are called virtual machines or VM."),Object(i.b)("p",null,"Virtual machine is a ",Object(i.b)("em",{parentName:"p"},"replication/simulation")," of an actual physical machine."),Object(i.b)("p",null,"A VM acts like a real physical machine and uses the physical resources of the underlying host OS."),Object(i.b)("p",null,"A VM is a running ",Object(i.b)("em",{parentName:"p"},"instance of a real physical machine.")),Object(i.b)("h3",{id:"need-for-virtualization"},Object(i.b)("em",{parentName:"h3"},"Need")," ",Object(i.b)("em",{parentName:"h3"},"for")," ",Object(i.b)("em",{parentName:"h3"},"virtualization")),Object(i.b)("p",null,"So; we have an overview of virtualization, let us examine when should we virtualize and what are the benefits of virtualization?"),Object(i.b)("ol",null,Object(i.b)("li",{parentName:"ol"},Object(i.b)("strong",{parentName:"li"},"Better resource management and")," ",Object(i.b)("strong",{parentName:"li"},"cost-effective"),": as indicated in Diagram (6) and Diagram (7); hardware resources are distributed wisely on need basis to different environments; all the virtual machines share the same resources and reduce resource wastage."),Object(i.b)("li",{parentName:"ol"},Object(i.b)("strong",{parentName:"li"},"Ease of quick administration and maintenance"),": It is easier to build, install, configure one server rather than multiple servers. Updating a patch on various machines from a single virtualized server is much more feasible."),Object(i.b)("li",{parentName:"ol"},Object(i.b)("strong",{parentName:"li"},"Disaster recovery"),": Since all the virtualized machines reside on the same server and are treated as mounted volumes of data files, it is easier to back up these machines. In case of a disaster failure (power failure, network down, cyber-attacks, failed test code, etc) VM screenshots are used to recover the running state of the machine and the whole setup can be built up within minutes."),Object(i.b)("li",{parentName:"ol"},Object(i.b)("strong",{parentName:"li"},"Isolated and independent secure test environment"),": virtualization provide an isolated independent virtual test environment to test the legacy code or a vendor-specific product or even a beta release or say a corrupt code without affecting the main hardware and software platform. (This is a contradictory statement though; will discuss more under types of virtualization)",Object(i.b)("br",{parentName:"li"}),"These test environments like dev, uat, preprod, prod etc..can be easily tested and discarded."),Object(i.b)("li",{parentName:"ol"},Object(i.b)("strong",{parentName:"li"},"Easily scalable and upgradable"),": Building up more simulated environments means spinning up more virtual machines. Also upgrading VMs is as good as to run a patch in all VMs."),Object(i.b)("li",{parentName:"ol"},Object(i.b)("strong",{parentName:"li"},"Portable"),": Virtual machines are lightweight compared to the actual running physical machines; in addition, a VM that includes its own OS, drivers, and other installation files is portable on any machine. One can access the data virtually from any location.")),Object(i.b)("p",null,"The screenshot of activity monitor below compares the CPU load:"),Object(i.b)("h2",{id:"implementation"},Object(i.b)("em",{parentName:"h2"},"Implementation")),Object(i.b)("h3",{id:"a-what-is-hypervisor-and-its-types__"},Object(i.b)("em",{parentName:"h3"},"a) What is hypervisor and its types__?")),Object(i.b)("p",null,"As discussed in the previous section; virtualization is achieved by means of a virtualized layer on top of hardware or a software resource."),Object(i.b)("p",null,"This abstract layer is called a ",Object(i.b)("em",{parentName:"p"},"hypervisor.")),Object(i.b)("p",null,"A hypervisor is a virtual machine monitor (VMM)"),Object(i.b)("p",null,"There are 2 types of hypervisors: Diagram (8)"),Object(i.b)("ol",null,Object(i.b)("li",{parentName:"ol"},"Type-1 or bare-metal hypervisor"),Object(i.b)("li",{parentName:"ol"},"Type-2 or hosted hypervisor")),Object(i.b)("p",null,Object(i.b)("em",{parentName:"p"},"Type-1 or bare-metal")," hypervisor is installed directly on the system hardware, thus abstracting and sharing the hardware components with the VMs."),Object(i.b)("p",null,Object(i.b)("em",{parentName:"p"},"Type-2 or hosted hypervisor")," is installed on top of the system bootable OS called host OS; this hypervisor abstracts the system resources visible to the host OS and distributes it among the VMs."),Object(i.b)("p",null,"Both have their own role to play in virtualization."),Object(i.b)("h3",{id:"b-comparing-hypervisor-types"},Object(i.b)("em",{parentName:"h3"},"b) Comparing hypervisor types")),Object(i.b)("p",null,"Type-1 or bare-metal hypervisor"),Object(i.b)("p",null,"Type-2 or hosted hypervisor"),Object(i.b)("p",null,"Installed ",Object(i.b)("em",{parentName:"p"},"directly on the infrastructure"),"-","OS independent and more secure against software issues."),Object(i.b)("p",null,"Installed ",Object(i.b)("em",{parentName:"p"},"on top of the host OS"),"-","more prone to software failures."),Object(i.b)("p",null,Object(i.b)("em",{parentName:"p"},"Better resource flexibility"),": Have direct access to the hardware infrastructure (Hard-drive partition, RAM, embedded cards such as NIC). Provide more flexibility and scalability to the VMs and assign resources on a need basis."),Object(i.b)("p",null,Object(i.b)("em",{parentName:"p"},"Limited resource allocation"),": Have access to just the resources exposed by the host OS."),Object(i.b)("p",null,"VMs installed will have limited access to hardware resources allocated and exposed by the host OS."),Object(i.b)("p",null,"Single point of failure: A compromised VM may affect the kernel. Extra security layers needed."),Object(i.b)("p",null,"A compromised VM may affect only the host OS, kernel still remains unreachable."),Object(i.b)("p",null,"Low latency due to direct link to the infrastructure."),Object(i.b)("p",null,"High latency as all the VMs have to pass through the OS layer to access the system resources."),Object(i.b)("p",null,"Generally used in Servers"),Object(i.b)("p",null,"Generally used on small client machines"),Object(i.b)("p",null,"Expensive"),Object(i.b)("p",null,"Less expensive"),Object(i.b)("p",null,"Type-1 Hypervisors in market:"),Object(i.b)("p",null,"VMWare ESX/ESXi"),Object(i.b)("p",null,"Hyperkit (OSX)"),Object(i.b)("p",null,"Microsoft Hyper-V (Windows)",Object(i.b)("br",{parentName:"p"}),"\n","KVM(Linux)"),Object(i.b)("p",null,"Oracle VM Server"),Object(i.b)("p",null,"Type-2 Hypervisors in market:"),Object(i.b)("p",null,"Oracle VM VirtualBox"),Object(i.b)("p",null,"VMWare Workstation"),Object(i.b)("p",null,"Parallels desktop for MAC"),Object(i.b)("h2",{id:"types-of-virtualization"},Object(i.b)("em",{parentName:"h2"},"Types of virtualization")),Object(i.b)("p",null,"Based on what resource is virtualized, there are different classifications of virtualization."),Object(i.b)("p",null,"Server, Storage device, operating system, network"),Object(i.b)("p",null,Object(i.b)("strong",{parentName:"p"},"Desktop")," ",Object(i.b)("strong",{parentName:"p"},"virtualization"),": Entire desktop environment is simulated and distributed to run on a single server all at once. A desktop virtualization allows administrators to manage, install, configure similar setups on many machines. Upgrading all the machines with a single patch update or security checks becomes easier and faster."),Object(i.b)("p",null,Object(i.b)("strong",{parentName:"p"},"Server")," ",Object(i.b)("strong",{parentName:"p"},"virtualization"),": Many dedicated servers can be virtualized into a single server that provides multi-server functionality."),Object(i.b)("p",null,Object(i.b)("strong",{parentName:"p"},"Example:")),Object(i.b)("p",null,"Many virtual machines can be built up sharing the same underlying system resources."),Object(i.b)("p",null,"Storage, RAM, disks, CPU"),Object(i.b)("p",null,Object(i.b)("strong",{parentName:"p"},"Operating system")," ",Object(i.b)("strong",{parentName:"p"},"virtualization"),": This happens at the kernel level Hypervisor on hardware type 2 bare-metal One machine: Can boot up as multiple OS like Windows or Linux side-by-side"),Object(i.b)("p",null,Object(i.b)("strong",{parentName:"p"},"Application virtualization"),": Apps are packaged and stored in a virtual environment and are distributed across different VMs. Example Microsoft applications like excel, MS word, Powerpoint etc, Citrix applications."),Object(i.b)("p",null,Object(i.b)("strong",{parentName:"p"},"Network functions virtualization"),": Physical network components such as NIC cards, switches, routers, servers, hubs, and cables are all assembled in a single server and used virtually by multiple machines without having the load of installing them on every machine."),Object(i.b)("p",null,"Virtualization is one of the building blocks and driving force behind ",Object(i.b)("a",{parentName:"p",href:"https://www.ibm.com/cloud/learn/cloud-computing"},Object(i.b)("em",{parentName:"a"},"cloud computing")),"."),Object(i.b)("p",null,"Cloud computing provide virtualized need-based services. This has given an uplift to the concept of virtualization."),Object(i.b)("p",null,"A quick mention of various cloud computing models/services are listed below:"),Object(i.b)("p",null,Object(i.b)("strong",{parentName:"p"},"SaaS")," \u2013 Software as a Service\u2013 end-user applications are maintained and run by service providers and easily distributed and used by the end users without having to install them."),Object(i.b)("p",null,"Top SaaS providers: Microsoft (Office suite, CRM, SQL server databases), AWS, Adobe, Oracle (ERP, CRM, SCM), Cisco\u2019s ",Object(i.b)("a",{parentName:"p",href:"https://www.webex.com/de/index.html"},"Webex"),", ",Object(i.b)("a",{parentName:"p",href:"https://github.com/"},"GitHub")," ( git hosting web service)"),Object(i.b)("p",null,Object(i.b)("strong",{parentName:"p"},"PaaS")," \u2013 Platform as a Service \u2013 computing infrastructure(hardware/software) is maintained and updated by the service provider and the user just have to run the product over this platform."),Object(i.b)("p",null,"Top Paas providers: ",Object(i.b)("a",{parentName:"p",href:"https://aws.amazon.com/elasticbeanstalk/"},"AWS beanstalk"),", ",Object(i.b)("a",{parentName:"p",href:"https://www.oracle.com/index.html"},"Oracle Cloud Platform (OCP)"),", ",Object(i.b)("a",{parentName:"p",href:"https://cloud.google.com/appengine/"},"Google App Engine")),Object(i.b)("p",null,Object(i.b)("strong",{parentName:"p"},"IaaS")," \u2013 Infrastructure as a Service \u2013 Provide infrastructure such as servers, physical storage, networking, memory devices etc. Users can build their own platform with customized operating system and applications."),Object(i.b)("p",null,"Key IaaS providers: Amazon Web Services, ",Object(i.b)("a",{parentName:"p",href:"https://azure.microsoft.com/en-us/"},"Microsoft Azure"),", Google compute engine, Citrix"),Object(i.b)("p",null,Object(i.b)("strong",{parentName:"p"},"Conclusion:")),Object(i.b)("p",null,"We now have a fair understanding of types of virtualization and how they are implemented."),Object(i.b)("h2",{id:"containerization"},Object(i.b)("strong",{parentName:"h2"},"Containerization")),Object(i.b)("p",null,"Though virtualization has its pros; there are certain downsides of virtualization such as:"),Object(i.b)("ul",null,Object(i.b)("li",{parentName:"ul"},"Not all systems can be virtualized always."),Object(i.b)("li",{parentName:"ul"},"A corrupt VM is sometimes contagious and may affect other VMs or the kernel in-case of a ",Object(i.b)("em",{parentName:"li"},"Type-1 or bare-metal")," hypervisor."),Object(i.b)("li",{parentName:"ul"},"Latency of virtual disks due to increased payload on the CPU resources with a higher number of VMs"),Object(i.b)("li",{parentName:"ul"},"Unstable performance")),Object(i.b)("p",null,"An alternative approach to overcome the above flaws of virtualization is to ",Object(i.b)("em",{parentName:"p"},"Containerize")," the applications and the run-time environment together."),Object(i.b)("h2",{id:"what-is-containerization"},Object(i.b)("em",{parentName:"h2"},"What is containerization")),Object(i.b)("p",null,Object(i.b)("em",{parentName:"p"},"Containerization")," is an OS-level virtualization; wherein the entire build of an application along with run-time environment is encapsulated or bundled up in a package."),Object(i.b)("p",null,"These packages are called ",Object(i.b)("em",{parentName:"p"},"containers"),"."),Object(i.b)("p",null,"Containers are lightweight virtualized environments. These are independent of the infrastructure both hardware and software."),Object(i.b)("p",null,"The run-time environment includes the operating system, binaries, libraries, configuration files and other applications as shown in Diagram (9)."),Object(i.b)("h2",{id:"what-is-dockers"},Object(i.b)("em",{parentName:"h2"},"What is Dockers")),Object(i.b)("p",null,Object(i.b)("em",{parentName:"p"},"Dockers")," provide an excellent framework for containerization and allow to build, ship, and run distributed applications over multiple platforms."),Object(i.b)("p",null,"Docker framework is setup as a ",Object(i.b)("em",{parentName:"p"},"docker engine")," installed on host OS and a ",Object(i.b)("a",{parentName:"p",href:"https://www.knowledgehut.com/devops/docker-training"},"docker")," ",Object(i.b)("em",{parentName:"p"},"daemon")," (background process) process is started that manage the virtual ",Object(i.b)("em",{parentName:"p"},"containers"),"."),Object(i.b)("p",null,"Refer Diagram (10) that shows a Docker engine with 3 containers residing on host OS (MAC OS)."),Object(i.b)("p",null,"An instruction file called ",Object(i.b)("em",{parentName:"p"},"dockerfile")," is written with a set of system commands that change the filesystem such as add, copy or delete commands, run commands, install utilities, system calls etc\u2026"),Object(i.b)("p",null,"This ",Object(i.b)("em",{parentName:"p"},"dockerfile")," is built and packaged along with its run-time environment as an executable file called a ",Object(i.b)("em",{parentName:"p"},"docker image.")),Object(i.b)("p",null,"Docker daemon services run these images to create ",Object(i.b)("em",{parentName:"p"},"docker containers.")),Object(i.b)("blockquote",null,Object(i.b)("p",{parentName:"blockquote"},Object(i.b)("em",{parentName:"p"},"Docker container is a run-time instance of an image"))),Object(i.b)("p",null,"It is wise to say that many images (or layers of instruction files) make up a container."),Object(i.b)("p",null,"Docker containers have a compact packaging and each container is well isolated."),Object(i.b)("p",null,"We can run, start, stop, attach, move or delete containers as these runs as services on the host OS."),Object(i.b)("p",null,"Each image is made up of different layers; each image based on top of the other with the customized command changes that we make."),Object(i.b)("p",null,"Every time we make a change in the filesystem, each change related to the image is encapsulated in a new layer of filesystem and stacked up above the parent image."),Object(i.b)("p",null,"Only the changed layers are rebuilt, rest of the unchanged image layers are reused."),Object(i.b)("p",null,"Certain docker commands ADD, RUN and COPY c",Object(i.b)("em",{parentName:"p"},"reate a new layer with increased byte size; rest of the commands simply adds up a new layer with zero-byte size.")),Object(i.b)("p",null,Object(i.b)("em",{parentName:"p"},"These layers are re-used to build a new image, hence faster and lightweight.")),Object(i.b)("p",null,"Docker images are also"),Object(i.b)("p",null,"The layer approach of an image every time there is a change in the image makes it possible to Version control the docker images."),Object(i.b)("p",null,"Here is a terminal recording that shows docker engine process and how images and containers are created."),Object(i.b)("p",null,"Docker documentation - to ",Object(i.b)("a",{parentName:"p",href:"https://docs.docker.com/get-started/part2/"},"create containers"),"."),Object(i.b)("h3",{id:"ppt-diagram"},Object(i.b)("strong",{parentName:"h3"},"Ppt diagram:")),Object(i.b)("p",null,"Code -> package -> build images -> registry hub -> download/pull image -> run container"),Object(i.b)("p",null,"Animation: sheet4"),Object(i.b)("p",null,"Let\u2019s consider the docker container: divyabhushan/learn","_","docker hosted on docker hub."),Object(i.b)("p",null,"Latest tagged image: centOS","_","release1.2"),Object(i.b)("h3",{id:"what-is-the-container-environment"},"What is the container environment?"),Object(i.b)("p",null,"Base OS: Centos:7"),Object(i.b)("p",null,"Utilities: vim, yum, git"),Object(i.b)("p",null,"Apps/files: Dockerfile, myApp.sh, runtests.sh, data and other supporting files."),Object(i.b)("p",null,"Git source code: ",Object(i.b)("a",{parentName:"p",href:"https://github.com/divyabhushan/DockerImages_Ubuntu.git"},"dockerImages")),Object(i.b)("p",null,"Download as: git clone ",Object(i.b)("a",{parentName:"p",href:"https://github.com/divyabhushan/DockerImages_Ubuntu.git"},"https://github.com/divyabhushan/DockerImages","_","Ubuntu.git")),Object(i.b)("p",null,"What does the container do?",Object(i.b)("br",{parentName:"p"}),"\n","Container launches \u201cmyApp.sh\u201d in Ubuntu:14.04 environment and run some scripts along with a set of post test","_","suites in the container (Ubuntu:14.04) and saves the output log file."),Object(i.b)("h2",{id:"how-to-modify-and-build-your-own-app"},Object(i.b)("em",{parentName:"h2"},"How to modify and build your own app")),Object(i.b)("h3",{id:"step-1-pull"},Object(i.b)("strong",{parentName:"h3"},"Step 1: pull")),Object(i.b)("p",null,Object(i.b)("strong",{parentName:"p"},"1.1: Pull the docker image")),Object(i.b)("p",null,Object(i.b)("strong",{parentName:"p"},"1.2: Run image to create a container and exit")),Object(i.b)("h3",{id:"step-2-modify"},Object(i.b)("strong",{parentName:"h3"},"Step 2: modify")),Object(i.b)("p",null,"2.1: Start the container"),Object(i.b)("p",null,"2.2: Attach to the container and make some changes"),Object(i.b)("h3",{id:"step-3-commit"},Object(i.b)("strong",{parentName:"h3"},"Step 3: commit")),Object(i.b)("p",null,"3.1: Examine the history logs and changes in the container"),Object(i.b)("p",null,"3.2: Commit the changes in container"),Object(i.b)("h3",{id:"step-4-push"},Object(i.b)("strong",{parentName:"h3"},"Step 4: push")),Object(i.b)("p",null,"4.1: Push new image to docker hub"),Object(i.b)("p",null,"Let us see the steps in action:"),Object(i.b)("h3",{id:"step-1-pull-1"},Object(i.b)("strong",{parentName:"h3"},"Step 1: pull")),Object(i.b)("p",null,"docker image on your machine"),Object(i.b)("p",null,"1.1: Pull the docker image"),Object(i.b)("p",null,Object(i.b)("strong",{parentName:"p"},"Command:")),Object(i.b)("p",null,"docker pull divyabhushan/learn","_","docker:myApp","_","ubuntu","_","14.04"),Object(i.b)("p",null,"View the image on system"),Object(i.b)("p",null,"docker images"),Object(i.b)("p",null,"screenshot"),Object(i.b)("p",null,Object(i.b)("strong",{parentName:"p"},"Command:")),Object(i.b)("p",null,"docker run -it --name ubuntu14.04 0a6f949131a6"),Object(i.b)("p",null,"Run command in ubuntu container and exit, the container is stopped on exiting out."),Object(i.b)("p",null,"View the stopped container with the \u2018ps -a\u2019 command."),Object(i.b)("h3",{id:"step-2-modify-1"},Object(i.b)("strong",{parentName:"h3"},"Step 2: modify")),Object(i.b)("p",null,"Start the container"),Object(i.b)("p",null,Object(i.b)("strong",{parentName:"p"},"Command:")),Object(i.b)("p",null,"docker start <container","_","id>"),Object(i.b)("p",null,"Now the container is listed as a running process Attach to the container and make some changes"),Object(i.b)("p",null,Object(i.b)("strong",{parentName:"p"},"Command:")),Object(i.b)("p",null,"docker attach 7d0d0225778c"),Object(i.b)("p",null,"edit the \u2018git configuration\u2019 file and \u2018myApp.sh\u2019 script"),Object(i.b)("p",null,"Container is modified and stopped"),Object(i.b)("h3",{id:"step-3-commit-1"},Object(i.b)("strong",{parentName:"h3"},"Step 3: commit")),Object(i.b)("p",null,"Examine the history logs and changes in the container"),Object(i.b)("p",null,"The changes done inside the container filesystem can be viewed using the \u2018docker diff\u2019 command as:"),Object(i.b)("p",null,Object(i.b)("strong",{parentName:"p"},"Command:")," "),Object(i.b)("p",null,"docker diff 7d0d0225778c"),Object(i.b)("p",null,"Commit the changes in container"),Object(i.b)("p",null,"Docker commit:"),Object(i.b)("p",null,"Usage: docker commit ","[","OPTIONS","]"," CONTAINER ","[","REPOSITORY","[",":TAG","]","]"),Object(i.b)("p",null,"docker commit -m 'new Ubuntu image' 7d0d0225778c divyabhushan/learn","_","docker:ubuntu14.04","_","v2"),Object(i.b)("p",null,"New image is created and listed"),Object(i.b)("h3",{id:"step-4-push-1"},Object(i.b)("strong",{parentName:"h3"},"Step 4: push")),Object(i.b)("p",null,"Push new image to docker hub"),Object(i.b)("p",null,Object(i.b)("strong",{parentName:"p"},"Command:")),Object(i.b)("p",null,"docker push divyabhushan/learn","_","docker:ubuntu14.04","_","v2"),Object(i.b)("p",null,"Point to note: just the latest commit change layer \u201850a5ce553bba\u2019 has been pushed, while the other layers were re-used."),Object(i.b)("p",null,"Image available on docker hub:"),Object(i.b)("p",null,"The latest tagged image can now be pulled from other machines; and run to create the same container environment."),Object(i.b)("p",null,Object(i.b)("strong",{parentName:"p"},"Conclusion"),": An image was pulled and run to create a container to replicate the environment. Container was modified, new changes were committed to form a new image. New Image pushed back on the docker hub and now available as a new tag ready to be pulled by other machines."),Object(i.b)("h2",{id:"difference-between-dockers-and-virtual-machines"},Object(i.b)("strong",{parentName:"h2"},"Difference between Dockers and Virtual machines")),Object(i.b)("h3",{id:"tabular-differences-on-various-parameters"},Object(i.b)("em",{parentName:"h3"},"Tabular differences on various parameters")),Object(i.b)("p",null,"Parameters"),Object(i.b)("p",null,"VMs"),Object(i.b)("p",null,"Dockers"),Object(i.b)("p",null,"architecture  "),Object(i.b)("p",null,Object(i.b)("em",{parentName:"p"},"Hardware level virtualization"),". Each VM has its own copy of OS.  "),Object(i.b)("p",null,Object(i.b)("em",{parentName:"p"},"Software level virtualization"),". Dockers have no own OS, run on host OS"),Object(i.b)("p",null,"Isolation"),Object(i.b)("p",null,"Fully isolated"),Object(i.b)("p",null,"Process or application-level isolation. \xa0"),Object(i.b)("p",null,"Installation"),Object(i.b)("p",null,"Hypervisor can ",Object(i.b)("em",{parentName:"p"},"run directly on the hardware")," resources or ",Object(i.b)("em",{parentName:"p"},"on the host OS"),"."),Object(i.b)("p",null,"Docker engine is installed ",Object(i.b)("em",{parentName:"p"},"on top of the host OS"),". A docker daemon process is initiated on the host OS. There is no separate OS for every container."),Object(i.b)("p",null,"CPU processing + performance"),Object(i.b)("p",null,Object(i.b)("em",{parentName:"p"},"Slower"),": A VM contains the entire run-time environment that has to be loaded every time. Uses more CPU cycles; gives unstable performance."),Object(i.b)("p",null,Object(i.b)("em",{parentName:"p"},"Faster"),": Docker images are pre-built and share host resources as a result running an image as a container is lightweight and consumes less CPU cycle; gives a stable performance"),Object(i.b)("p",null,"Hardware storage"),Object(i.b)("p",null,"More storage space as each VM is an independent machine (OS). Example: 3 VMs of 800MB each will take 2.4 GB of space."),Object(i.b)("p",null,"Docker containers are lightweight since do not require to load OS+drivers, run on host OS as processes."),Object(i.b)("p",null,"Portable"),Object(i.b)("p",null,"Dependency on host OS and hardware makes VM less portable. Importing a VM still requires manual setup such storage, RAM and network."),Object(i.b)("p",null,"Highly portable since lightweight and zero dependency on hardware."),Object(i.b)("p",null,"Scalable and code-reusability"),Object(i.b)("p",null,"Spinning up more VMs still need administrative tasks such as distributing resources to VM. Running a new machine puts extra load on the system resources also re-managing earlier VMs becomes a task. Every VM keeps its own copy of resources-poor code-reusability."),Object(i.b)("p",null,"Spinning up new docker containers simply means running pre-built images into containers as a process inside host OS. Containers are also configured on-the-fly passing parameters and run-time. Single image can be run and used to create many containers; encourage code-reusability"),Object(i.b)("p",null,"Resource utilization"),Object(i.b)("p",null,"Static allocation results in resource wastage in case of idle VMs or if a VM\u2019s resource requirement increases."),Object(i.b)("p",null,"Resources are dynamically allocated and de-allocated on the need basis by the docker engine."),Object(i.b)("p",null,"Docker system prune or garbage collection"),Object(i.b)("p",null,"Virtual machines do not have an in-built prune mechanism, these have to be ",Object(i.b)("em",{parentName:"p"},"administered manually"),"."),Object(i.b)("p",null,"Docker image and containers can be pruned; which frees up a sensible amount of storage and memory space and CPU cycles."),Object(i.b)("p",null,"New environment"),Object(i.b)("p",null,"Creating new VM from the scratch is a tedious, repetitive tasks. It involves installing a new OS, loading kernel drivers and other tools and configurations."),Object(i.b)("p",null,"Package the code and dependency files, build into an image, run the image to create a new container. Use an existing or a base image (dockerhub- ",Object(i.b)("a",{parentName:"p",href:"https://hub.docker.com/_/scratch"},"scratch"),") to run and create more containers on the go."),Object(i.b)("p",null,"Web-hosted Hub"),Object(i.b)("p",null,"No web hosted hub for VMs"),Object(i.b)("p",null,Object(i.b)("a",{parentName:"p",href:"https://hub.docker.com/search/?type=image"},"dockerHub")," provides an open-source reliable trusted source of pre-built images that can be downloaded to run new containers."),Object(i.b)("p",null,"Version control (backup, restore,track history)"),Object(i.b)("p",null,"(refer ",Object(i.b)("a",{parentName:"p",href:"https://www.knowledgehut.com/tutorials/git-tutorial/introduction-to-git"},"git"),")"),Object(i.b)("p",null,"Snapshot of VMs are not very user-friendly and consume more space."),Object(i.b)("p",null,"Docker images are version controlled. "),Object(i.b)("p",null,"Every delta difference in each docker container can easily be viewed (demo: docker diff <container","_","id>). "),Object(i.b)("p",null,"Any change in the image is stored as a different layered version. A reference link to older images saves build time and space."),Object(i.b)("p",null,"Auto-build"),Object(i.b)("p",null,"Automation of creating VMs is not very feasible."),Object(i.b)("p",null,"Docker images can also be auto-built from every source code check-in to GitHub (Automated builds on Dockerhub)"),Object(i.b)("p",null,"Disaster recovery"),Object(i.b)("p",null,"Tedious to recover from VM backup files."),Object(i.b)("p",null,"Easier to restore docker images (like files) just like git source files in case images are version controlled. Backup images only have to be run to create containers. (refer: screenshot)."),Object(i.b)("p",null,"Update"),Object(i.b)("p",null,"All the VMs have to updated with the release patch."),Object(i.b)("p",null,"A single image is updated, re-built and distributed across multiple platforms."),Object(i.b)("p",null,"Memory usage+speed"),Object(i.b)("p",null,"Slower: Entire snapshot of a machine and the OS is loaded into the cache memory."),Object(i.b)("p",null,"Real-time and fast: pre-built images. Only the instance, i.e, a container has to be run as a process and uses memory like an executable"),Object(i.b)("p",null,"Data integrity"),Object(i.b)("p",null,"VM behavior may change if the dependency includes beyond the VM boundaries. (example: an app depends on production host network settings)"),Object(i.b)("p",null,"Same behavior of apps in any environment"),Object(i.b)("p",null,"security"),Object(i.b)("p",null,"More secure: A failure inside a VM may reach its guest OS but not the host OS or other virtual machines. Type-2 hypervisor though has a risk of kernel attack."),Object(i.b)("p",null,"Less secure: If a docker container compromised; underlying OS and hence all the containers may be affected since they share the same host kernel. OS Kernel may also be risked."),Object(i.b)("p",null,"Key providers"),Object(i.b)("p",null,Object(i.b)("a",{parentName:"p",href:"https://www.redhat.com/en/topics/virtualization/what-is-KVM"},"Red hat KVM"),", VMWare, Oracle VM VirtualBox, Mircrosoft Hyper-V, Citrix XenServer"),Object(i.b)("p",null,Object(i.b)("a",{parentName:"p",href:"https://www.mirantis.com/software/docker/docker-enterprise/"},"Dockers"),",\xa0",Object(i.b)("a",{parentName:"p",href:"https://cloud.google.com/kubernetes-engine/"},"Google kubernetes Engine"),",\xa0",Object(i.b)("a",{parentName:"p",href:"https://aws.amazon.com/ecs/"},"AWS Elastic Container service")),Object(i.b)("p",null,"Data authentication"),Object(i.b)("p",null,"Lot of software licenses."),Object(i.b)("p",null,"Docker maintains inbuilt content trust to verify published images."),Object(i.b)("h2",{id:"when-to-use-vm-or-a-docker"},Object(i.b)("em",{parentName:"h2"},"When to use VM or a Docker")),Object(i.b)("p",null,"When the need is an isolated OS, go for VMs."),Object(i.b)("p",null,"For a hardware and software independent isolated application that needs fast distribution on multiple environments, use dockers."),Object(i.b)("ul",null,Object(i.b)("li",{parentName:"ul"},Object(i.b)("h3",{parentName:"li",id:"docker-use-case"},"Docker use-case:"))),Object(i.b)("p",null,"Example: A database application along with its database"),Object(i.b)("p",null,"Consider the docker image - ",Object(i.b)("a",{parentName:"p",href:"https://hub.docker.com/_/oracle-weblogic-server-12c?tab=description"},"Oracle WebLogic Server")," on ",Object(i.b)("a",{parentName:"p",href:"https://hub.docker.com/"},"Docker Hub"),"."),Object(i.b)("p",null,"This image is pre-built Oracle WebLogic Server runtime environment, including Oracle Linux 7 and Oracle JDK 8 for deploying Java EE applications."),Object(i.b)("p",null,"To create Server configurations on any machine, just download this image and run to create and start a container."),Object(i.b)("p",null,"There is no need to install and configure JDK, Linux or other run-time environment."),Object(i.b)("ul",null,Object(i.b)("li",{parentName:"ul"},Object(i.b)("h3",{parentName:"li",id:"do-not-use-docker-use-case"},"Do not use Docker use-case:"))),Object(i.b)("p",null,"The application depends on utility outside the docker container."),Object(i.b)("p",null,"Code developed on dev machine with base OS as MAC; needs certain firewall setting on say Ubuntu OS."),Object(i.b)("p",null,"How can the code be tested on the production ubuntu OS firewall while running from MAC OS docker container?"),Object(i.b)("p",null,"Solution: \xa0Install a virtualization software on host OS-MAC; Create a VM (Virtual machine) with host OS as Ubuntu (same as production environment)."),Object(i.b)("p",null,"Configure the desired firewall settings on host VM \u2013 Ubuntu; import the test code inside Ubuntu and test."),Object(i.b)("ul",null,Object(i.b)("li",{parentName:"ul"},Object(i.b)("h3",{parentName:"li",id:"use-a-vm"},"Use a VM:"))),Object(i.b)("p",null,"For Embedded systems programming, a VM is installed that connects to the system device drivers, controllers and kernel."),Object(i.b)("ul",null,Object(i.b)("li",{parentName:"ul"},Object(i.b)("h3",{parentName:"li",id:"virtualization-used-along-with-docker"},"Virtualization used along with docker:"))),Object(i.b)("p",null,"An extension to the previous scenario would be if you would want to also test your python application in the host OS-Ubuntu VM without having to set up the python exe and its libraries and binaries."),Object(i.b)("p",null,"All you have to do is: Install ",Object(i.b)("a",{parentName:"p",href:"https://www.knowledgehut.com/devops/docker-training"},"Docker")," engine for Ubuntu OS and pull the python image from Docker hub as:"),Object(i.b)("p",null,"docker pull python:tag ","["," tag is the python version-choose the appropriate version ","]"),Object(i.b)("p",null,"docker pull python:2.7"),Object(i.b)("p",null,"Refer: ",Object(i.b)("a",{parentName:"p",href:"https://hub.docker.com/_/python/"},"Python image")),Object(i.b)("p",null,"Either write a Dockerfile to import/copy entire source code to python environment or directly run the image passing the script path as below:"),Object(i.b)("p",null,"Command:"),Object(i.b)("p",null,"$docker run -it --name my-python-script -v \u201c$PWD\u201d:/usr/src/myapp -w /usr/src/myapp python:2.7 python my-application.py"),Object(i.b)("p",null,"Command options:"),Object(i.b)("p",null,"-","v = volume list-bind mount a volume ","[","mount present working directory onto /usr/src/myapp inside container","]"),Object(i.b)("p",null,"-","w = workdir string-working directory inside the container"),Object(i.b)("p",null,"Moreover; you can also test your python code in more than one version by downloading different python images, running them to create different containers and running your app in each container."),Object(i.b)("p",null,"What\u2019s exciting here is that once the code tested in each python environment; you could quickly work on the test results and drop the containers. And deploy the code to production only once code tested against various python versions."),Object(i.b)("h4",{id:"final-thoughts"},Object(i.b)("em",{parentName:"h4"},"Final thoughts")),Object(i.b)("p",null,"VMs and dockers are compatible with each other. Dockers are not here to replace Virtual machines."),Object(i.b)("p",null,"Both serve the same purpose of virtualizing the computing and infrastructure resources for optimized utilization."),Object(i.b)("p",null,"Using both Virtual machines and dockers together can yield better results in virtualization."),Object(i.b)("p",null,"When one desires a fast, lightweight, portable and highly scalable hardware-independent environment for multiple applications isolation; wherein security is not the major concern; Dockers is the best choice."),Object(i.b)("p",null,"Use a VM for embedded systems that are integrated with hardware; such as device driver or kernel coding."),Object(i.b)("p",null,"A scenario simulating an infrastructure setup with a high resource control and dependency on system resources; VMs are a better choice."),Object(i.b)("p",null,"Use of Dockers inside VM"),Object(i.b)("p",null,"CI/CD pipelines scenario:"),Object(i.b)("p",null,"Virtualization enables a smooth CI/CD process flow by promoting the users to concentrate only on developing the code on a working system that is set up for automated continuous integration and deployment without having to duplicate the entire setup each time."),Object(i.b)("p",null,"A virtualized environment is set up; either using a VM or a docker image that takes care of the automatic code check-ins, builds, regression testing, and deployments on the server."))}b.isMDXComponent=!0},113:function(e,t,n){"use strict";n.d(t,"a",(function(){return u})),n.d(t,"b",(function(){return h}));var a=n(0),r=n.n(a);function i(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function o(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function s(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?o(Object(n),!0).forEach((function(t){i(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):o(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function c(e,t){if(null==e)return{};var n,a,r=function(e,t){if(null==e)return{};var n,a,r={},i=Object.keys(e);for(a=0;a<i.length;a++)n=i[a],t.indexOf(n)>=0||(r[n]=e[n]);return r}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)n=i[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}var l=r.a.createContext({}),b=function(e){var t=r.a.useContext(l),n=t;return e&&(n="function"==typeof e?e(t):s(s({},t),e)),n},u=function(e){var t=b(e.components);return r.a.createElement(l.Provider,{value:t},e.children)},p={inlineCode:"code",wrapper:function(e){var t=e.children;return r.a.createElement(r.a.Fragment,{},t)}},d=r.a.forwardRef((function(e,t){var n=e.components,a=e.mdxType,i=e.originalType,o=e.parentName,l=c(e,["components","mdxType","originalType","parentName"]),u=b(n),d=a,h=u["".concat(o,".").concat(d)]||u[d]||p[d]||i;return n?r.a.createElement(h,s(s({ref:t},l),{},{components:n})):r.a.createElement(h,s({ref:t},l))}));function h(e,t){var n=arguments,a=t&&t.mdxType;if("string"==typeof e||a){var i=n.length,o=new Array(i);o[0]=d;var s={};for(var c in t)hasOwnProperty.call(t,c)&&(s[c]=t[c]);s.originalType=e,s.mdxType="string"==typeof e?e:a,o[1]=s;for(var l=2;l<i;l++)o[l]=n[l];return r.a.createElement.apply(null,o)}return r.a.createElement.apply(null,n)}d.displayName="MDXCreateElement"},114:function(e,t,n){"use strict";n.d(t,"b",(function(){return i})),n.d(t,"a",(function(){return o}));var a=n(22),r=n(115);function i(){const{siteConfig:{baseUrl:e="/",url:t}={}}=Object(a.default)();return{withBaseUrl:(n,a)=>function(e,t,n,{forcePrependBaseUrl:a=!1,absolute:i=!1}={}){if(!n)return n;if(n.startsWith("#"))return n;if(Object(r.b)(n))return n;if(a)return t+n;const o=n.startsWith(t)?n:t+n.replace(/^\//,"");return i?e+o:o}(t,e,n,a)}}function o(e,t={}){const{withBaseUrl:n}=i();return n(e,t)}},115:function(e,t,n){"use strict";function a(e){return!0===/^(\w*:|\/\/)/.test(e)}function r(e){return void 0!==e&&!a(e)}n.d(t,"b",(function(){return a})),n.d(t,"a",(function(){return r}))},116:function(e,t,n){"use strict";var a=n(0),r=n.n(a),i=n(11),o=n(115),s=n(8);const c=Object(a.createContext)({collectLink:()=>{}});var l=n(114),b=function(e,t){var n={};for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&t.indexOf(a)<0&&(n[a]=e[a]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var r=0;for(a=Object.getOwnPropertySymbols(e);r<a.length;r++)t.indexOf(a[r])<0&&Object.prototype.propertyIsEnumerable.call(e,a[r])&&(n[a[r]]=e[a[r]])}return n};t.a=function(e){var t,{isNavLink:n,to:u,href:p,activeClassName:d,isActive:h,"data-noBrokenLinkCheck":m}=e,O=b(e,["isNavLink","to","href","activeClassName","isActive","data-noBrokenLinkCheck"]);const{withBaseUrl:g}=Object(l.b)(),j=Object(a.useContext)(c),v=u||p,f=Object(o.a)(v),y=null==v?void 0:v.replace("pathname://",""),w=void 0!==y?(e=>e.startsWith("/"))(k=y)?g(k):k:void 0;var k;const N=Object(a.useRef)(!1),S=n?i.e:i.c,M=s.a.canUseIntersectionObserver;let V;Object(a.useEffect)((()=>(!M&&f&&window.docusaurus.prefetch(w),()=>{M&&V&&V.disconnect()})),[w,M,f]);const z=null!==(t=null==w?void 0:w.startsWith("#"))&&void 0!==t&&t,D=!w||!f||z;return w&&f&&!z&&!m&&j.collectLink(w),D?r.a.createElement("a",Object.assign({href:w},v&&!f&&{target:"_blank",rel:"noopener noreferrer"},O)):r.a.createElement(S,Object.assign({},O,{onMouseEnter:()=>{N.current||(window.docusaurus.preload(w),N.current=!0)},innerRef:e=>{var t,n;M&&e&&f&&(t=e,n=()=>{window.docusaurus.prefetch(w)},V=new window.IntersectionObserver((e=>{e.forEach((e=>{t===e.target&&(e.isIntersecting||e.intersectionRatio>0)&&(V.unobserve(t),V.disconnect(),n())}))})),V.observe(t))},to:w||""},n&&{isActive:h,activeClassName:d}))}}}]);